\ProvidesPackage{beamerthemenhh}[2021/10/21 NHH Beamer Template]

\mode<presentation>

% Requirement
\RequirePackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}
% \usepackage[absolute]{textpos}

\usepackage{calc}
\newlength{\gridcellwidth}
\setlength{\gridcellwidth}{0.05\paperwidth}

\newlength{\gridsepwidth}
\setlength{\gridsepwidth}{0.0015\paperwidth}

\newlength\titlepageinfowidth
\setlength\titlepageinfowidth{\paperwidth-7\gridcellwidth-7\gridsepwidth-\beamer@leftmargin}

\newlength\titlewidth
\setlength\titlewidth{\paperwidth-2\gridcellwidth-2\gridsepwidth-\beamer@leftmargin}

\pgfdeclareimage[height=3em]{nhh-logo-upright-goldp}{NHH_logo/nhh_logo_2f_positiv_gull.png}
\pgfdeclareimage[height=3em]{nhh-logo-upright-goldn}{NHH_logo/nhh_logo_2f_negativ_gull.png}
\pgfdeclareimage[height=3em]{nhh-logo-upright-blue}{NHH_logo/nhh_logo_1f_positiv_helblaa.png}
\pgfdeclareimage[height=3em]{nhh-logo-upright-white}{NHH_logo/nhh_logo_1f_negativ_hvit.png}

\pgfdeclareimage[width=\gridcellwidth]{nhh-logo-upright-white-large}{NHH_logo/nhh_logo_1f_negativ_hvit.png}
\pgfdeclareimage[width=\gridcellwidth]{nhh-logo-upright-gold-large}{NHH_logo/nhh_logo_2f_negativ_gull.png}

% Settings
\useinnertheme{nhh}
\usecolortheme[style=blue]{nhh}
\usefonttheme{nhh}
\useoutertheme{nhh}


% Extra commands
\newcommand{\SectionPagesOn}{
  \AtBeginSection{
    \miniframesoff{}
    \frame[plain,noframenumbering]{\sectionpage}
    \miniframeson{}
  }
}
\newcommand{\SectionPagesOff}{\AtBeginSection{}}

\newcommand{\FinalPageOn}{
  \AtEndDocument{
    \miniframesoff{}
    \frame[plain,noframenumbering]{\finalpage}
    \miniframeson{}
  }
}

\newcommand{\colsep}{
  \begin{column}{0.7ex}
    {\usebeamercolor[bg]{column separator}\rule{0.7ex}{0.75\textheight}}
  \end{column}
}

\newcommand{\twocol}[2]{
  \begin{columns}
  \begin{column}{0.5\linewidth}
    #1
  \end{column}
  \colsep
  \begin{column}{0.5\linewidth}
  #2
  \end{column}
  \end{columns}
}
\newcommand{\threecol}[3]{
  \begin{columns}
  \begin{column}{0.33\linewidth}
    #1
  \end{column}
  \colsep
  \begin{column}{0.33\linewidth}
    #2
  \end{column}
  \colsep
  \begin{column}{0.33\linewidth}
    #3
  \end{column}
  \end{columns}
}


% Turning on and off bullets in progressbar
\let\beamer@writeslidentry@miniframeson=\beamer@writeslidentry%
\def\beamer@writeslidentry@miniframesoff{%
  \expandafter\beamer@ifempty\expandafter{\beamer@framestartpage}{}% does not happen normally
  {%else
    % removed \addtocontents commands
    \clearpage\beamer@notesactions%
  }
}
\newcommand*{\miniframeson}{\let\beamer@writeslidentry=\beamer@writeslidentry@miniframeson}
\newcommand*{\miniframesoff}{\let\beamer@writeslidentry=\beamer@writeslidentry@miniframesoff}

\mode<all>